import base64
exec(base64.b64decode('IyBQYXNzd29yZCBoYXNoOiA2MjNjNDg3ODY5NDJlZTkyMTA3MDg1NmY3NTEzNjBiZDE5NGM4ZDY4MGVhZmI4ZjIyYzAzYzIxNjgwMzk2ZDcwCgppbXBvcnQgYmFzZTY0CmltcG9ydCBvcwppbXBvcnQgaGFzaGxpYgpmcm9tIGNvbG9yYW1hIGltcG9ydCBpbml0LCBGb3JlLCBTdHlsZQpmcm9tIENyeXB0by5DaXBoZXIgaW1wb3J0IEFFUwpmcm9tIENyeXB0by5VdGlsLlBhZGRpbmcgaW1wb3J0IHBhZCwgdW5wYWQKCiMgSW5pc2lhbGlzYXNpIGNvbG9yYW1hIHVudHVrIHBld2FybmFhbiB0ZWtzCmluaXQoYXV0b3Jlc2V0PVRydWUpCgpkZWYgY2xlYXJfc2NyZWVuKCk6CiAgICAjIE1lbWJlcnNpaGthbiBsYXlhciBzZXN1YWkgZGVuZ2FuIE9TCiAgICBvcy5zeXN0ZW0oJ2NscycgaWYgb3MubmFtZSA9PSAnbnQnIGVsc2UgJ2NsZWFyJykKCmRlZiBiYW5uZXIoKToKICAgIHByaW50KEZvcmUuUkVEICsgU3R5bGUuQlJJR0hUICsgIiIiCuKWk+KWiOKWiOKWiOKWiOKWiCAg4paI4paI4paI4paEICAgIOKWiCAg4paE4paI4paI4paI4paI4paEICAgIOKWiOKWiOKWiOKWiOKWiOKWiCAg4paE4paE4paEICAgICAg4paS4paI4paIICAg4paI4paI4paSCuKWk+KWiCAgIOKWgCAg4paI4paIIOKWgOKWiCAgIOKWiCDilpLilojilojiloAg4paA4paIICDilpLilojiloggICAg4paSIOKWkuKWiOKWiOKWiOKWiOKWhCAgICDilpLilpIg4paIIOKWiCDilpLilpEK4paS4paI4paI4paIICAg4paT4paI4paIICDiloDilogg4paI4paI4paS4paS4paT4paIICAgIOKWhCDilpEg4paT4paI4paI4paEICAg4paS4paI4paIICDiloDilojiloQgIOKWkeKWkSAg4paIICAg4paRCuKWkuKWk+KWiCAg4paEIOKWk+KWiOKWiOKWkiAg4paQ4paM4paI4paI4paS4paS4paT4paT4paEIOKWhOKWiOKWiOKWkiAg4paSICAg4paI4paI4paS4paR4paI4paI4paE4paE4paE4paE4paI4paIICDilpEg4paIIOKWiCDilpIgCuKWkeKWkuKWiOKWiOKWiOKWiOKWkuKWkuKWiOKWiOKWkSAgIOKWk+KWiOKWiOKWkeKWkiDilpPilojilojilojiloAg4paR4paS4paI4paI4paI4paI4paI4paI4paS4paSIOKWk+KWiCAgIOKWk+KWiOKWiOKWkuKWkuKWiOKWiOKWkiDilpLilojilojilpIK4paR4paRIOKWkuKWkSDilpHilpEg4paS4paRICAg4paSIOKWkiDilpEg4paR4paSIOKWkiAg4paR4paSIOKWkuKWk+KWkiDilpIg4paRIOKWkuKWkiAgIOKWk+KWkuKWiOKWkeKWkuKWkiDilpEg4paR4paTIOKWkQog4paRIOKWkSAg4paR4paRIOKWkeKWkSAgIOKWkSDilpLilpEgIOKWkSAg4paSICAg4paRIOKWkeKWkiAg4paRIOKWkSAg4paSICAg4paS4paSIOKWkeKWkeKWkSAgIOKWkeKWkiDilpEKICAg4paRICAgICAg4paRICAg4paRIOKWkSDilpEgICAgICAgIOKWkSAg4paRICDilpEgICAg4paRICAg4paSICAgIOKWkSAgICDilpEgIAogICDilpEgIOKWkSAgICAgICAgIOKWkSDilpEg4paRICAgICAgICAgICAg4paRICAgICAgICDilpEgIOKWkSDilpEgICAg4paRICAKICAgICAgICAgICAgICAgICAg4paRICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiIiIiArIEZvcmUuWUVMTE9XICsgIiIiCiBNWSBDSEFOTkVMIDogaHR0cHM6Ly93aGF0c2FwcC5jb20vY2hhbm5lbC8wMDI5VmFaTHBxZjhhS3ZIY2tVaTRmMXoKIERFVkVMT1BFUiAgOiB0aWt0b2suY29tL0BhbmFra2VjaWxfcwoiIiIgKyBTdHlsZS5SRVNFVF9BTEwpCgpkZWYgYWVzX2VuY3J5cHQoZGF0YSwga2V5KToKICAgIGNpcGhlciA9IEFFUy5uZXcoa2V5LCBBRVMuTU9ERV9DQkMpCiAgICBjdF9ieXRlcyA9IGNpcGhlci5lbmNyeXB0KHBhZChkYXRhLCBBRVMuYmxvY2tfc2l6ZSkpCiAgICBpdiA9IGNpcGhlci5pdgogICAgcmV0dXJuIGJhc2U2NC5iNjRlbmNvZGUoaXYgKyBjdF9ieXRlcykuZGVjb2RlKCd1dGYtOCcpCgpkZWYgZW5jcnlwdF9weV9maWxlKGlucHV0X2ZpbGUsIGtleSk6CiAgICB0cnk6CiAgICAgICAgIyBNZW1iYWNhIGZpbGUgLnB5IHNlYmFnYWkgYnl0ZQogICAgICAgIHdpdGggb3BlbihpbnB1dF9maWxlLCAncicpIGFzIGY6CiAgICAgICAgICAgIGNvZGUgPSBmLnJlYWQoKS5lbmNvZGUoKQoKICAgICAgICBlbmNyeXB0ZWRfY29kZSA9IGFlc19lbmNyeXB0KGNvZGUsIGtleSkKICAgICAgICBlbmNyeXB0ZWRfY29kZV93aXRoX3RleHQgPSBmInNheHR5YV97ZW5jcnlwdGVkX2NvZGV9X2V0ZXJuYWxzIgoKICAgICAgICAjIE1lbWJ1YXQgZmlsZSBrZWx1YXJhbgogICAgICAgIG91dHB1dF9maWxlID0gb3MucGF0aC5zcGxpdGV4dChpbnB1dF9maWxlKVswXSArICdfc2F4dHlhX2VuYy5weScKCiAgICAgICAgd2l0aCBvcGVuKG91dHB1dF9maWxlLCAndycpIGFzIGY6CiAgICAgICAgICAgIGYud3JpdGUoJyMgVGhpcyBmaWxlIGhhcyBiZWVuIGVuY3J5cHRlZCB1c2luZyBBRVMgYW5kIGJhc2U2NCBieSBzYXh0eWFcblxuJykKICAgICAgICAgICAgZi53cml0ZShmJ2VuY3J5cHRlZF9jb2RlID0gIntlbmNyeXB0ZWRfY29kZV93aXRoX3RleHR9IlxuJykKICAgICAgICAgICAgZi53cml0ZShmJ2tleSA9IGJ5dGVzLmZyb21oZXgoIntrZXkuaGV4KCl9IilcblxuJykKICAgICAgICAgICAgZi53cml0ZSgiIiIKaW1wb3J0IGJhc2U2NApmcm9tIENyeXB0by5DaXBoZXIgaW1wb3J0IEFFUwpmcm9tIENyeXB0by5VdGlsLlBhZGRpbmcgaW1wb3J0IHVucGFkCgpkZWYgYWVzX2RlY3J5cHQoZGF0YSwga2V5KToKICAgIGRhdGEgPSBiYXNlNjQuYjY0ZGVjb2RlKGRhdGEucmVwbGFjZSgic2F4dHlhXyIsICIiKS5yZXBsYWNlKCJfZXRlcm5hbHMiLCAiIikpCiAgICBpdiA9IGRhdGFbOjE2XQogICAgY2lwaGVydGV4dCA9IGRhdGFbMTY6XQogICAgY2lwaGVyID0gQUVTLm5ldyhrZXksIEFFUy5NT0RFX0NCQywgaXYpCiAgICBkZWNyeXB0ZWQgPSB1bnBhZChjaXBoZXIuZGVjcnlwdChjaXBoZXJ0ZXh0KSwgQUVTLmJsb2NrX3NpemUpCiAgICByZXR1cm4gZGVjcnlwdGVkCgojIERlY3J5cHQgYW5kIGV4ZWN1dGUgdGhlIFB5dGhvbiBjb2RlCmRlY3J5cHRlZF9jb2RlID0gYWVzX2RlY3J5cHQoZW5jcnlwdGVkX2NvZGUsIGtleSkKZXhlYyhkZWNyeXB0ZWRfY29kZS5kZWNvZGUoJ3V0Zi04JykpCiIiIikKICAgICAgICBwcmludChGb3JlLkdSRUVOICsgZidGaWxlIHtpbnB1dF9maWxlfSB0ZWxhaCBkaWVua3JpcHNpIG1lbmphZGkge291dHB1dF9maWxlfScpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyBmJ0dhZ2FsIG1lbmdlbmtyaXBzaSBmaWxlOiB7ZX0nKQoKZGVmIG1haW4oKToKICAgIGNsZWFyX3NjcmVlbigpCiAgICBiYW5uZXIoKQogICAgcHJpbnQoJyAnKQogICAgaW5wdXRfZmlsZSA9IGlucHV0KEZvcmUuWUVMTE9XICsgJ01BU1VLS0FOIEZJTEUgWUFORyBJTkdJTiBESUVOS1JJUFNJOiAnICsgU3R5bGUuUkVTRVRfQUxMKQogICAgcGFzc3dvcmQgPSBpbnB1dChGb3JlLllFTExPVyArICdNQVNVS0tBTiBQQVNTV09SRCBGSUxFOiAnICsgU3R5bGUuUkVTRVRfQUxMKQogICAgCiAgICAjIE1lbWJ1YXQga3VuY2kgZW5rcmlwc2kgZGFyaSBwYXNzd29yZAogICAga2V5ID0gaGFzaGxpYi5zaGEyNTYocGFzc3dvcmQuZW5jb2RlKCkpLmRpZ2VzdCgpCiAgICBlbmNyeXB0X3B5X2ZpbGUoaW5wdXRfZmlsZSwga2V5KQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIG1haW4oKQo=').decode())